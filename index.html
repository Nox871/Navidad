<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Una pequeña carta</title>

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            min-height: 100vh;
            font-family: "Courier New", monospace;
            background: #0b1020;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        /* =========================
   ESCENA
========================= */
        .scene {
            width: 100%;
            max-width: 900px;
            aspect-ratio: 16 / 9;
            background:
                linear-gradient(rgba(0, 0, 0, .6), rgba(0, 0, 0, .6)),
                url("fondo02.png") center / cover no-repeat;
            border: 4px solid #b91c1c;
            box-shadow: 0 0 0 4px #facc15;
            padding: 16px;
            display: flex;
            gap: 16px;
        }

        /* =========================
   PERSONAJE
========================= */
        .character {
            flex: 0 0 220px;
            background: #111827;
            border: 2px solid #facc15;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .character img {
            width: 100%;
            max-width: 160px;
            image-rendering: pixelated;
        }

        /* =========================
   DIÁLOGO
========================= */
        .dialogue-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .dialogue-box {
            background: #020617;
            border: 2px solid #facc15;
            padding: 14px 16px;
            min-height: 120px;
            font-size: 15px;
            line-height: 1.6;
            color: #f8fafc;
        }

        .hint {
            margin-top: 6px;
            font-size: 12px;
            color: #fde68a;
            text-align: right;
        }

        /* =========================
   REGALOS
========================= */
        .gifts {
            display: none;
            margin-top: 16px;
            gap: 12px;
        }

        .gift {
            flex: 1;
            background: #020617;
            border: 2px solid #b91c1c;
            box-shadow: 0 0 0 2px #facc15 inset;
            padding: 10px;
            cursor: pointer;
            transition: transform .2s;
            text-align: center;
        }

        .gift:hover {
            transform: translateY(-4px);
        }

        .gift img {
            width: 100%;
            max-width: 80px;
            image-rendering: pixelated;
        }

        /* =========================
   RESPONSIVE
========================= */
        @media (max-width: 768px) {
            .scene {
                flex-direction: column;
                aspect-ratio: auto;
            }

            .character {
                height: 180px;
                flex: none;
            }

            .gifts {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>

    <div class="scene">
        <div class="character">
            <img id="santaSprite" src="happy-santa.png" alt="Santa">
        </div>

        <div class="dialogue-area">
            <div class="dialogue-box" id="dialogue"></div>
            <div class="hint" id="hint">[ toca la pantalla para continuar ]</div>

            <div class="gifts" id="gifts">
                <div class="gift" data-gift="calma">
                    <img src="regalo01.png" alt="">
                </div>
                <div class="gift" data-gift="compania">
                    <img src="regalo02.png" alt="">
                </div>
                <div class="gift" data-gift="esperanza">
                    <img src="regalo03.png" alt="">
                </div>
            </div>
        </div>
    </div>

    <audio id="bgm" loop preload="auto">
        <source src="grandpa_intro.mp3" type="audio/mpeg">
    </audio>

    <script>
        const dialogueBox = document.getElementById("dialogue");
        const hint = document.getElementById("hint");
        const bgm = document.getElementById("bgm");
        const santaSprite = document.getElementById("santaSprite");
        const gifts = document.getElementById("gifts");

        const dialogues = [
            "Hola...",
            "Gracias por tomarte un momento para estar aquí.",
            "A veces, el año pasa más rápido de lo que esperamos.",
            "Y otras veces… pesa un poco más.",
            "Hay cosas que no se pueden envolver.",
            "Pero siguen siendo importantes.",
            "Elige uno."
        ];

        let index = 0;
        let typing = false;
        let musicStarted = false;

        function typeText(text) {
            typing = true;
            dialogueBox.textContent = "";
            let i = 0;

            const interval = setInterval(() => {
                dialogueBox.textContent += text[i];
                i++;
                if (i >= text.length) {
                    clearInterval(interval);
                    typing = false;
                }
            }, 45);
        }

        function nextDialogue() {
            if (typing) return;

            santaSprite.src = "happy-santa02.png";

            if (!musicStarted) {
                bgm.volume = 0.15;
                bgm.play().catch(() => { });
                musicStarted = true;
            }

            if (index < dialogues.length) {
                typeText(dialogues[index]);
                index++;
            } else {
                hint.textContent = "";
                gifts.style.display = "flex";
                document.body.removeEventListener("click", nextDialogue);
            }
        }

        document.body.addEventListener("click", nextDialogue);

        document.querySelectorAll(".gift").forEach(gift => {
            gift.addEventListener("click", () => {
                santaSprite.src = "happy-santa02.png";

                const messages = {
                    calma: "Que encuentres calma incluso en los días más ruidosos.",
                    compania: "Aunque no siempre se note, nunca caminas solo.",
                    esperanza: "Siempre hay algo bueno esperando más adelante."
                };

                typeText(messages[gift.dataset.gift]);
                gifts.style.display = "none";
            });
        });

        // Primer texto
        typeText(dialogues[index]);
        index++;
    </script>

</body>

</html>